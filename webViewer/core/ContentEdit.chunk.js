(function(){(window.wpCoreControlsBundle=window.wpCoreControlsBundle||[]).push([[7],{143:function(e,t,r){function n(e,t,r,n){return Object(E.b)(void 0,void 0,void 0,(function(){var a,o,l,c,s,u,m,g,f;return Object(E.d)(this,(function(d){switch(d.label){case 0:return a=x.getDocument(),o=[1],[4,Object(w.c)(t,{extension:"pdf"})];case 1:return l=d.ea(),c=x.Ga(),m=(u=S.a).n$,[4,l.Ry()];case 2:return s=m.apply(u,[d.ea().xfdfString,e]),g=!0,[4,a.Ue(l,o,e,g)];case 3:return d.ea(),[4,a.Ef([e+1],g)];case 4:return d.ea(),f=c.Eg().filter((function(t){return t.AP()&&t.PageNumber===e})),c.yt(f,{force:!0,source:"contentEditTool"}),[4,c.dP(s)];case 5:return d.ea(),x.getDocument().kH(),x.jH(e),x.pe(),i(e),p(e,r.galleys,n),p(e,r.objects,n),[2]}}))}))}function a(e){return e=(new DOMParser).parseFromString(e,"text/html").documentElement.querySelector("body"),e.querySelectorAll("p").forEach((function(e){e.querySelectorAll("span").forEach((function(e){var t=e.getAttribute("style");t=o(t,e.innerHTML),e.innerHTML=t}));var t=e.getAttribute("style"),r=e.innerHTML.replaceAll("<br>","");e.innerHTML=o(t,r)})),e.innerHTML.trim()}function o(e,t){return e.includes("bold")&&(t="<strong>"+t+"</strong>"),e.includes("italic")&&(t="<em>"+t+"</em>"),e.includes("text-decoration: underline")&&(t="<u>"+t+"</u>"),t}function i(e){var t=x.Ga(),r=t.Eg().filter((function(t){return t.pu()&&t.PageNumber===e}));t.yt(r,{force:!0,source:"contentEditTool"})}function l(e,t){t.forEach((function(t){V[e]||(V[e]=[]),V[e].find((function(e){return e.id===t.id}))||V[e].push(t)}))}function c(e,t){t.forEach((function(t){C[e]||(C[e]=[]),C[e].find((function(e){return e.id===t.id}))||C[e].push(t)}))}function s(e){var t=new DOMParser,r=t.parseFromString(e,"text/xml");return r.querySelector("parsererror")&&(r=t.parseFromString("<Root>"+e+"</Root>","text/xml")),r.querySelectorAll("a").forEach((function(e){var t=e.childNodes[0];Array.from(e.querySelectorAll("*")).find((function(e){return"u"===e.tagName.toLowerCase()}))||(e=document.createElement("u"),t.after(e),e.appendChild(t))})),(new XMLSerializer).serializeToString(r)}function u(e,t,r,n){this.top=e,this.left=t,this.bottom=r,this.right=n,this.topVal=function(){return Math.round(this.top)},this.bottomVal=function(){return Math.round(this.bottom)},this.leftVal=function(){return Math.round(this.left)},this.rightVal=function(){return Math.round(this.right)},this.height=function(){return Math.round(Math.abs(this.top-this.bottom))},this.width=function(){return Math.round(this.right-this.left)},this.YL=function(e){return this.topVal()!==e.topVal()||this.leftVal()!==e.leftVal()||this.bottomVal()!==e.bottomVal()||this.rightVal()!==e.rightVal()}}function m(e,t,r,n,a){this.id=e,this.pagenum=t,this.galleysContents=r,this.contents=n,this.galleyBox=a,Object(F.d)(C)}function g(e,t,r,n){this.id=t,this.type=e,this.bbox=r,this.pagenum=n}function f(e,t,r,n,a){this.id=e,this.pagecount=t,this.pageBBox=r,this.galleys=n,this.objects=a}function d(e,t,r,n,a){var o=[];(new DOMParser).parseFromString(n,"text/html").documentElement.querySelectorAll("p").forEach((function(e,t){o[t]=e.innerHTML})),r=(new DOMParser).parseFromString(r,"text/html");var i=null;for(r.documentElement.querySelectorAll("p").forEach((function(e,t){t<o.length?(e.innerHTML=o[t],i=e.getAttribute("style"),i=i.replace("font:italic","font:normal"),i=i.replace(" bold "," normal "),i=i.replace("underline:1;","underline:0;"),e.setAttribute("style",i)):e.remove()})),n=r.documentElement.querySelectorAll("p").length;n<o.length;n++){var l=document.createElement("p");l.setAttribute("id","0"),l.innerHTML=o[n],null!=i&&l.setAttribute("style",i),r.documentElement.querySelector("body").appendChild(l)}r=r.documentElement.querySelector("body").innerHTML;var c="";return C[e].forEach((function(e){e.id===a&&(c=e)})),""===c?"":(t="<DOC id='"+t.id+"' pagecount='"+t.pagecount+"'>",t=t+"<STORY galley_ids='"+a+"' pagenum='"+e+"'><galleys>"+c.galleysContents+"</galleys>",c.contents=r,t=t+r+"\n</STORY>",t+"</DOC>")}function p(e,t,r){var n=[],a=x.getDocument(),o=null;t.forEach((function(t){if(t instanceof g){var i=a.am(e,t.bbox.leftVal(),t.bbox.topVal()),l=i.x,c=i.y,s=a.am(e,t.bbox.rightVal(),t.bbox.bottomVal());i=s.x,s=s.y}else{if(!(t instanceof m))return;i=a.am(e,t.galleyBox.leftVal(),t.galleyBox.topVal()),l=i.x,c=i.y,s=a.am(e,t.galleyBox.rightVal(),t.galleyBox.bottomVal()),i=s.x,s=s.y}var u=new window.Core.Annotations.RectangleAnnotation,f=j.a.OBJECT;t instanceof m&&(f=j.a.TEXT),u.Lba(t,f),u.PageNumber=t.pagenum,u.X=l,u.Y=c,u.Width=i-l,u.Height=s-c,u.StrokeColor=new M.a("#3183C8"),u.FillColor=new M.a(255,255,255,.01),u.Style="dash",u.Dashes="4,3",u.WM(),u.selectionModel=B.a,n.push(u),"undefined"!==typeof r&&r===t.id&&(o=u)})),t=x.Ga(),t.kn(n),o&&t.No(o),t.Ki(n)}function b(e,t,r){return Object(E.b)(this,void 0,void 0,(function(){var a,o,s,u;return Object(E.d)(this,(function(m){switch(m.label){case 0:switch(a=e.data,s=a.cmd,s){case"isReady":return[3,1];case"initialiseInfixServer":return[3,3];case"exportFile":return[3,4];case"importText":return[3,5];case"transformObject":return[3,5];case"deleteObject":return[3,6]}return[3,7];case 1:return[4,Object(O.b)()];case 2:return u=m.ea(),D.postMessage({cmd:"initialiseInfixServer",l:u}),[3,7];case 3:return h(a.resultsXML)?t():r("License key does not have content edit permission"),[3,7];case 4:return a.exportPerformed?y(a.pageNumber,a.exportXML,a.objectXML,a.resultsXML):(o=P[a.pageNumber],c(a.pageNumber,o.galleys),l(a.pageNumber,o.objects),i(a.pageNumber),p(a.pageNumber,o.galleys),p(a.pageNumber,o.objects)),[3,7];case 5:return o=P[a.pageNumber],N(a.pageNumber,a.resultsXML),n(a.pageNumber,a.pdfBuffer,o,a.id),[3,7];case 6:return o=P[a.pageNumber],N(a.pageNumber,a.resultsXML),o.galleys=o.galleys.filter((function(e){return e.id!==a.id})),o.objects=o.objects.filter((function(e){return e.id!==a.id})),n(a.pageNumber,a.pdfBuffer,o),[3,7];case 7:return[2]}}))}))}function h(e){e=new Uint8Array(e);var t=new TextDecoder("utf-8").decode(e);return e=!1,t=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("LicenseCheck"),null!==t&&0<t.length&&(t=t[0].getElementsByTagName("Status")[0].innerHTML,"error"!==t&&"ok"===t&&(e=!0)),e}function y(e,t,r,n){var a=new Uint8Array(t),o=new TextDecoder("utf-8");t=o.decode(a),a=new Uint8Array(r),r=o.decode(a),a=new Uint8Array(n),n=o.decode(a),P[e]=v(e,t,r,n),n=P[e],c(e,n.galleys),l(e,n.objects),i(e),p(e,n.galleys),p(e,n.objects)}function T(e,t){return e=parseFloat(e),isNaN(t)||t<e?e:t}function v(e,t,r,n){var a,o=new DOMParser;n=o.parseFromString(n,"text/xml"),Array.prototype.slice.call(n.getElementsByTagName("BBox")).forEach((function(e){if("CropBox"===e.getAttribute("Name")){var t=parseFloat(e.getElementsByTagName("Top").item(0).innerHTML),r=parseFloat(e.getElementsByTagName("Bottom").item(0).innerHTML),n=parseFloat(e.getElementsByTagName("Left").item(0).innerHTML);e=parseFloat(e.getElementsByTagName("Right").item(0).innerHTML),a=new u(t,n,r,e)}})),o=new DOMParser,n=o.parseFromString(t,"text/xml");var i=[];Array.prototype.slice.call(n.getElementsByTagName("STORY")).forEach((function(t){var r=t.getAttribute("galley_ids"),n=Array.prototype.slice.call(t.getElementsByTagName("g"))[0],a=n.getAttribute("bbox").split(" ");a=new u(parseFloat(a[0]),parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3])),n=n.innerHTML;var o=Array.prototype.slice.call(t.getElementsByTagName("galleys"))[0];o.parentNode.removeChild(o),t=t.innerHTML,t=(new DOMParser).parseFromString(t,"text/html").documentElement.querySelector("body").innerHTML.trim(),r=new m(r,e,n,t,a),i.push(r)})),o=new DOMParser;var l=[];return t=o.parseFromString(r,"text/xml").getElementsByTagName("Object"),Array.prototype.slice.call(t).forEach((function(t){var r=t.getAttribute("Type"),n=t.getAttribute("OID");t=Array.prototype.slice.call(t.getElementsByTagName("Point"));var a=Number.NaN,o=Number.NaN,i=Number.NaN,c=Number.NaN;t.forEach((function(e){var t=e.getAttribute("Name");"TL"===t?(a=T(e.getAttribute("Y"),a),i=T(e.getAttribute("X"),i)):"TR"===t?(a=T(e.getAttribute("Y"),a),c=T(e.getAttribute("X"),c)):"BR"===t?(o=T(e.getAttribute("Y"),o),c=T(e.getAttribute("X"),c)):"BL"===t&&(o=T(e.getAttribute("Y"),o),i=T(e.getAttribute("X"),i))})),t=new u(a,i,o,c),r=new g(r,n,t,e),l.push(r)})),t=Array.prototype.slice.call(n.getElementsByTagName("DOC"))[0].getAttribute("id"),new f(t,1,a,i,l)}function N(e,t){var r;t=new TextDecoder("utf-8").decode(t);var n=(new DOMParser).parseFromString(t,"text/xml");if(t=n.getElementsByTagName("Galley").item(0),null!=t){var a=t.getAttribute("id");t=n.getElementsByTagName("BBox"),t=Array.prototype.slice.call(t),t.forEach((function(e){var t=e.getElementsByTagName("Top"),n=parseFloat(t.item(0).innerHTML);t=e.getElementsByTagName("Left");var a=parseFloat(t.item(0).innerHTML);t=e.getElementsByTagName("Bottom");var o=parseFloat(t.item(0).innerHTML);t=e.getElementsByTagName("Right"),e=parseFloat(t.item(0).innerHTML),r=new u(n,a,o,e)})),C[e].forEach((function(e){e.id===a&&!0===r.YL(e.galleyBox)&&(e.galleyBox=r)}))}if(t=n.getElementsByTagName("Object").item(0),null!=t){var o=t.getAttribute("OID");t=n.getElementsByTagName("BBox"),t=Array.prototype.slice.call(t),t.forEach((function(e){var t=e.getElementsByTagName("Top"),n=parseFloat(t.item(0).innerHTML);t=e.getElementsByTagName("Left");var a=parseFloat(t.item(0).innerHTML);t=e.getElementsByTagName("Bottom");var o=parseFloat(t.item(0).innerHTML);t=e.getElementsByTagName("Right"),e=parseFloat(t.item(0).innerHTML),r=new u(n,a,o,e)})),V[e].forEach((function(e){e.id===o&&!0===r.YL(e.bbox)&&(e.bbox=r)}))}if(t=n.getElementsByTagName("NewParas").item(0),null!=t){var i=t.getAttribute("id");C[e].forEach((function(e){if(e.id===i){var t="<Contents>"+e.contents;t+="</Contents>";var r=Array.prototype.slice.call(n.getElementsByTagName("NewPara"));t=(new DOMParser).parseFromString(t,"text/xml");var a=Array.prototype.slice.call(t.getElementsByTagName("p"));r.forEach((function(e){var t=parseFloat(e.innerHTML),r=!1;a.forEach((function(e){var n=e.getAttribute("id");!1===r&&"0"===n&&(e.setAttribute("id",t),r=!0)}))})),e.contents=t.getElementsByTagName("Contents").item(0).innerHTML}}))}}r.r(t);var x,E=r(1),w=r(49),M=r(17),B=r(429),A=r(34),O=r(68),L=r(2),j=r(258),F=r(154),S=r(6),D=null,H=null,C={},V={},P={};t["default"]={l$:function(e){return Object(E.b)(void 0,void 0,void 0,(function(){return Object(E.d)(this,(function(){return H||(x=e,H=new Promise((function(e,t){D=new Worker(window.Core.getWorkerPath()+"contentEdit/InfixServerModule.js"),D.onmessage=function(r){b(r,e,t)},D.postMessage({cmd:"isReady"})}))),[2,H]}))}))},Fja:function(e,t,r){return Object(E.b)(void 0,void 0,void 0,(function(){var n,a,o,l;return Object(E.d)(this,(function(c){switch(c.label){case 0:return i(t),C[t]=[],V[t]=[],[4,e.$d([t])];case 1:return n=c.ea(),a=new TextEncoder,o=a.encode(""),l=o.buffer,D.postMessage({cmd:"exportFile",pageNumber:t,performExport:r,pdfFile:n,tableData:l},[n,l]),[2]}}))}))},Cga:function(e){return Object(E.b)(void 0,void 0,void 0,(function(){var t,r,n,a,o,i,l,c;return Object(E.d)(this,(function(s){switch(s.label){case 0:return t=e.id,r=e.isText,n=e.pageNumber,a=x.getDocument(),[4,a.$d([n])];case 1:return o=s.ea(),i=new TextEncoder,l=i.encode(""),c=l.buffer,D.postMessage({cmd:"deleteObject",pdfFile:o,pageNumber:n,objectID:t,isText:r,tableData:c},[c]),[2]}}))}))},Yka:function(e){return Object(E.b)(void 0,void 0,void 0,(function(){var t,r,n,a,o,i,l,c,s,u,m,g,f;return Object(E.d)(this,(function(d){switch(d.label){case 0:return t=e.id,r=e.position,n=r.top,a=r.left,o=r.bottom,i=r.right,l=e.isText,c=e.pageNumber,s=x.getDocument(),[4,s.$d([c])];case 1:return u=d.ea(),m=new TextEncoder,g=m.encode(""),f=g.buffer,D.postMessage({cmd:"transformObject",pdfFile:u,pageNumber:c,objectID:t,isText:l,topVal:n,leftVal:a,bottomVal:o,rightVal:i,tableData:f},[f]),[2]}}))}))},Vda:function(e,t){return Object(E.b)(void 0,void 0,void 0,(function(){var r,n,o,i,l,c,u,m,g,f,p,b,h,y,T,v,N,w;return Object(E.d)(this,(function(E){switch(E.label){case 0:return r=t.replaceAll("<p><br></p>",""),n=s(r),n=n.replace(/<span style="color: var\(--text-color\);">(.*?)<\/span>/g,"$1"),o=e.mC.id,i=e.PageNumber,l=P[i],c=l.galleys.find((function(e){return e.id===o})),u=a(c.contents),m=d(i,l,u,n,o),""===m?[3,2]:(g=new TextEncoder,f=g.encode(m),p=f.buffer,b=Object(A.c)()||"https://www.pdftron.com/webfonts/v2/",h=x.getDocument(),[4,h.$d([i])]);case 1:return y=E.ea(),g=new TextEncoder,T=g.encode(""),v=T.buffer,D.postMessage({cmd:"importText",pdfFile:y,pageNumber:i,webFontURL:b,galleyId:o,importData:p,tableData:v},[p,v]),N={},c&&(w=c.galleyBox,N={top:w.top,left:w.left,bottom:w.bottom,right:w.right}),Object(F.e)(u,n,N),[3,3];case 2:Object(L.g)("Unable to generate import XML"),E.label=3;case 3:return[2]}}))}))},A4:function(e){if(e)return a(e.contents);Object(L.g)("Unable to extract document content")}}},429:function(e,t,r){var n=r(1);e=r(73);var a=r(45);r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.c)(t,e),t.prototype.testSelection=function(e,t,r){return a.a.Oj(e,t,r)},t}(e.a),t.a=r}}])}).call(this||window);