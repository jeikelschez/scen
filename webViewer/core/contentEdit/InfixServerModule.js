(function(){(function(e){function t(r){if(a[r])return a[r].exports;var n=a[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var a={};t.m=e,t.c=a,t.d=function(e,a,r){t.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:r})},t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,a){if(1&a&&(e=t(e)),8&a||4&a&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var n in e)t.d(r,n,function(t){return e[t]}.bind(null,n));return r},t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/core/contentEdit",t(t.s=0)})([function(e,t,a){e.exports=a(1)},function(e,t,a){function r(e,t,a){commandFName="importCommand"+a+".xml",FS.writeFile(commandFName,"<InfixServer>"+e+"</InfixServer>"),l.ccall("wasmRunXML","number",["string","string"],[commandFName,t]),FS.unlink(commandFName)}function n(){1==o?postMessage({cmd:"isReady"}):setTimeout(n,300)}function m(e,t,a,n,m){t?(a=new Uint8Array(a),t="inputFile"+e+".pdf",FS.writeFile(t,a),n=new Uint8Array(n),n=new TextDecoder("utf-8").decode(n),exportedFName="exported"+e+".xml",objectFName="objects"+e+".xml",resultsFName="results"+e+".xml",a='<Commands><Command Name="LoadPDF"><File>'+t+'</File></Command><Command Name="Page BBox"><StartPage>1</StartPage><EndPage>1</EndPage></Command>',""!=n&&(a+='<Command Name="AddTableBoxes">'+n+"</Command>"),a=a+'<Command Name="Translate Export"><File>'+exportedFName+"</File><TransXML>coreTransXML.cfg</TransXML>",a=a+'<StartPage>1</StartPage><EndPage>1</EndPage></Command><Command Name="Edit Page"><Output>'+objectFName+"</Output><ImagesOnly/></Command></Commands>",r(a,resultsFName,1),i=e,m&&(m=FS.readFile(t).buffer,t=FS.readFile(exportedFName).buffer,n=FS.readFile(objectFName).buffer,a=FS.readFile(resultsFName).buffer,FS.unlink(resultsFName),FS.unlink(exportedFName),FS.unlink(objectFName),hasBeenExported=!0,postMessage({cmd:"exportFile",pageNumber:e,exportPerformed:!0,pdfBuffer:m,exportXML:t,objectXML:n,resultsXML:a},[m,t,a]))):postMessage({cmd:"exportFile",pageNumber:e,exportPerformed:!1})}var o=!1,i=-1,l={noInitialRun:!0,onRuntimeInitialized:function(){o=!0}};self.Module=l,importScripts("InfixServer.js"),onmessage=function(e){switch(e=e.data,e.cmd){case"isReady":n();break;case"initialiseInfixServer":e=e.l,l.callMain([""]),l.ccall("wasmInitInfixServer","number",["string","string","string"],["infixcore.cfg",e,"results"]),e=FS.readFile("results").buffer,postMessage({cmd:"initialiseInfixServer",resultsXML:e},[e]);break;case"exportFile":m(e.pageNumber,e.performExport,e.pdfFile,e.tableData,!0);break;case"importText":var t=e.pdfFile,a=e.pageNumber,o=e.webFontURL,s=e.galleyId,u=e.tableData;e=new Uint8Array(e.importData);var d=new TextDecoder("utf-8").decode(e);a!=i&&m(a,!0,t,u,!1),e="editText"+a+".xml",FS.writeFile(e,d),t="outputFile"+a+".pdf",u=resultsFName="results"+a+".xml",d='<Commands><Command Name="Translate Import"><File>'+e+'</File><StartPage>1</StartPage><EndPage>LastPage</EndPage><AutoSubstitute/><AutoDeleteParas/><Fitting><Shrink><FontSize Min="0.65">true</FontSize><Leading>False</Leading></Shrink><Stretch><FontSize>False</FontSize>',d+="<Leading>False</Leading></Stretch></Fitting>",d+="<ResetLetterSpacing/><IgnoreFlightCheck/>",d+="<MissingFont>Noto Sans Regular</MissingFont><SubstituteAllChars/>",d+="<WebFontURL>"+o+"</WebFontURL>",d+="<TargetLang>en</TargetLang></Command>",d+='<Command Name="SavePDF"><File>'+t+"</File></Command>",d+='<Command Name="DumpObjectBBox"><GID>'+s+"</GID></Command></Commands>",r(d,u,a),o=FS.readFile(t).buffer,u=FS.readFile(resultsFName).buffer,FS.unlink(t),FS.unlink(resultsFName),FS.unlink(e),postMessage({cmd:"importText",pageNumber:a,pdfBuffer:o,resultsXML:u,id:s},[o,u]);break;case"transformObject":a=e.pageNumber,s=e.objectID;var F=e.isText;o=e.topVal,t=e.leftVal,u=e.bottomVal,d=e.rightVal;var f='<Commands><Command Name="TransformToRect">';a!=i&&m(a,!0,e.pdfFile,e.tableData,!1),e="outputFile"+a+".pdf",resultsFName="results"+a+".xml",F=!0===F?"<GID>"+s+"</GID>":"<OID>"+s+"</OID>",f=f+F+"<Rect><Top>"+o+"</Top><Left>"+t+"</Left><Bottom>"+u+"</Bottom><Right>"+d+"</Right></Rect></Command>",f+='<Command Name="SavePDF"><File>'+e+"</File></Command>",r(f+'<Command Name="DumpObjectBBox">'+F+"</Command></Commands>",resultsFName,a),o=FS.readFile(e).buffer,t=FS.readFile(resultsFName).buffer,FS.unlink(e),FS.unlink(resultsFName),postMessage({cmd:"transformObject",pageNumber:a,pdfBuffer:o,resultsXML:t,id:s},[o,t]);break;case"deleteObject":a=e.pageNumber,s=e.objectID,o=e.isText,a!=i&&m(a,!0,e.pdfFile,e.tableData,!1),e="outputFile"+a+".pdf",resultsFName="results"+a+".xml",t='<Commands><Command Name="DeleteObject">',t=(!0===o?t+"<GID>"+s+"</GID></Command>":t+"<OID>"+s+"</OID></Command>")+'<Command Name="SavePDF"><File>'+e+"</File></Command></Commands>",r(t,resultsFName,a),o=FS.readFile(e).buffer,t=FS.readFile(resultsFName).buffer,FS.unlink(e),FS.unlink(resultsFName),postMessage({cmd:"deleteObject",pageNumber:a,pdfBuffer:o,resultsXML:t,id:s},[o,t])}}}])}).call(this||window);