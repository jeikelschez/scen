"use strict";(globalThis["webpackChunktest"]=globalThis["webpackChunktest"]||[]).push([[5797],{93899:(e,s,o)=>{function a(e,s,o,a,t,i){return null}o.d(s,{A:()=>c});var t=o(45022),i=o(80660),l=o(14907);const n={setup(){const e=(0,l.A)();return{errorDelServidor(){this.$emit("resetLoading"),e.notify({message:this.error,color:"red"})},añadidoConExito(){e.notify({message:"Agregado exitosamente",color:"green"})},editadoConExito(){e.notify({message:"Editado exitosamente",color:"green"})},eliminadoConExito(){e.notify({message:"Eliminado exitosamente",color:"green"})}}},methods:{getData:function(e,s,o,a={headers:{}}){a.headers.Authorization=`Bearer ${t.A.getItem("token")}`,i.api.get(e,a).then((e=>{this.$emit(s,e.data,o)})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor(),this.$emit("resetLoading")}))},createData:function(e,s,o,a={headers:{}}){a.headers.Authorization=`Bearer ${t.A.getItem("token")}`,i.api.post(e,s,a).then((e=>{(e.status=200)&&(this.$emit(o),this.añadidoConExito())})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor(),this.$emit("resetLoading")}))},putData:function(e,s,o,a={headers:{}}){a.headers.Authorization=`Bearer ${t.A.getItem("token")}`,i.api.put(e,s,a).then((e=>{(e.status=200)&&(this.$emit(o),this.editadoConExito())})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor()}))},deleteData:function(e,s,o={headers:{}}){o.headers.Authorization=`Bearer ${t.A.getItem("token")}`,i.api.delete(e,o).then((e=>{(e.status=200)&&(this.$emit(s),this.eliminadoConExito())})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor(),this.$emit("resetLoading")}))},login:function(e,s,o,a={headers:{}}){a.headers.Authorization=`Bearer ${t.A.getItem("token")}`,i.api.post(e,s,a).then((e=>{(e.status=200)&&this.$emit(o,e.data)})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor()}))}}};var r=o(12807);const d=(0,r.A)(n,[["render",a]]),c=d},15797:(e,s,o)=>{o.r(s),o.d(s,{default:()=>B});var a=o(61758),t=o(58790);const i={class:"row items-center"},l={key:0,class:"col-md-9 col-sm-10 col-xs-9"},n={class:"titleCheckbox"},r={key:1,class:"col-md-2 col-sm-2 col-xs-3",style:{"text-align":"right"}},d={class:"row justify-center items-center",style:{"margin-bottom":"10px","margin-top":"40px"}},c={class:"row q-pa-sm justify-center"},m={class:"col-md-12 col-xl-12 col-lg-12 col-xs-12 col-sm-12"},u={class:"q-pa-md row",style:{"margin-top":"2px"}},p=(0,a.Lk)("div",{class:"col-md-3 col-xl-3 col-lg-3 col-xs-12 col-sm-12 movilTitle",style:{"align-self":"center","text-align":"center"}},[(0,a.Lk)("p",{style:{"font-size":"20px"},class:"text-secondary"},[(0,a.Lk)("strong",null,"SEGURIDAD - PERMISOLOGÍA")])],-1),h={class:"col-md-6 col-xl-6 col-lg-6 col-xs-12 col-sm-6 cardMargin selectMobile",style:{"align-self":"center","text-align":"center"}},g={class:"col-md-6 col-xl-6 col-lg-6 col-xs-12 col-sm-6 selectMobile",style:{"align-self":"center","text-align":"center"}},b={class:"q-pa-md my-card row",bordered:"",flat:"",style:{"margin-top":"2px"}};function k(e,s,o,k,f,w){const y=(0,a.g2)("q-checkbox"),A=(0,a.g2)("q-btn"),x=(0,a.g2)("q-card-section"),V=(0,a.g2)("q-card"),D=(0,a.g2)("q-dialog"),F=(0,a.g2)("q-item-section"),v=(0,a.g2)("q-item"),_=(0,a.g2)("q-icon"),P=(0,a.g2)("q-select"),S=(0,a.g2)("q-inner-loading"),C=(0,a.g2)("q-td"),I=(0,a.g2)("q-item-label"),Q=(0,a.g2)("q-list"),U=(0,a.g2)("q-table"),$=(0,a.g2)("methods"),q=(0,a.g2)("q-page"),L=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.Wv)(q,{class:"pagina q-pa-md"},{default:(0,a.k6)((()=>[(0,a.bF)(D,{modelValue:k.permisosForm,"onUpdate:modelValue":s[0]||(s[0]=e=>k.permisosForm=e)},{default:(0,a.k6)((()=>[(0,a.bF)(V,{class:"q-pa-md",bordered:"",style:{width:"900px","max-width":"80vw"}},{default:(0,a.k6)((()=>[(0,a.bF)(x,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.form.acciones,((e,s)=>((0,a.uX)(),(0,a.CE)("div",i,[s>3?((0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("p",n,(0,t.v_)(e.descripcion),1)])):(0,a.Q3)("",!0),s>3?((0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(y,{modelValue:e.bpermisos,"onUpdate:modelValue":[s=>e.bpermisos=s,s=>w.updatePermisos(e)],class:"checkboxItem",disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])):(0,a.Q3)("",!0)])))),256)),(0,a.Lk)("div",d,[(0,a.bo)((0,a.bF)(A,{label:"Cerrar",color:"primary",class:"col-md-5 col-sm-5 col-xs-12",icon:"close"},null,512),[[L]])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.Lk)("div",c,[(0,a.Lk)("div",m,[(0,a.Lk)("div",u,[p,(0,a.Lk)("div",h,[(0,a.bF)(P,{rounded:"","transition-show":"flip-up","transition-hide":"flip-down",options:f.agenciasSelected,onFilter:s[1]||(s[1]=(e,s)=>w.filterArray(e,s,"agenciasSelected","agencias","nb_agencia")),"use-input":"","hide-selected":"","fill-input":"",dense:"","input-debounce":"0","option-label":"nb_agencia","option-value":"id",modelValue:f.selectedAgencia,"onUpdate:modelValue":[s[2]||(s[2]=e=>f.selectedAgencia=e),s[3]||(s[3]=e=>{w.getData("/roles","setDataRoles","rolesPermisos",{headers:{agencia:this.selectedAgencia.id}}),this.menus=[]})],outlined:"",standout:"",label:"Escoge una Agencia"},{"no-option":(0,a.k6)((()=>[(0,a.bF)(v,null,{default:(0,a.k6)((()=>[(0,a.bF)(F,{class:"text-grey"},{default:(0,a.k6)((()=>[(0,a.eW)(" Sin resultados ")])),_:1})])),_:1})])),prepend:(0,a.k6)((()=>[(0,a.bF)(_,{name:"search"})])),_:1},8,["options","modelValue"])]),(0,a.Lk)("div",g,[(0,a.bF)(P,{rounded:"","transition-show":"flip-up","transition-hide":"flip-down",options:f.rolesPermisosSelected,onFilter:s[4]||(s[4]=(e,s)=>w.filterArray(e,s,"rolesPermisosSelected","rolesPermisos","descripcion")),"use-input":"","hide-selected":"","fill-input":"",dense:"","input-debounce":"0","option-label":"descripcion","option-value":"id",modelValue:f.selectedRol,"onUpdate:modelValue":[s[5]||(s[5]=e=>f.selectedRol=e),s[6]||(s[6]=e=>{w.getData("/menus","setDataMenus","menus",{headers:{rol:this.selectedRol.id}}),this.menus=[]})],outlined:"",standout:"",label:"Escoge un Rol"},{"no-option":(0,a.k6)((()=>[(0,a.bF)(v,null,{default:(0,a.k6)((()=>[(0,a.bF)(F,{class:"text-grey"},{default:(0,a.k6)((()=>[(0,a.eW)(" Sin resultados ")])),_:1})])),_:1})])),prepend:(0,a.k6)((()=>[(0,a.bF)(_,{name:"search"})])),_:1},8,["options","modelValue"])])]),(0,a.Lk)("div",b,[(0,a.bF)(U,{rows:f.menus,"row-key":"id",columns:f.columnsPermisos,loading:k.loading,"binary-state-sort":"",separator:k.separator,style:{width:"100%"},grid:e.$q.screen.xs,pagination:f.pagination,"onUpdate:pagination":s[7]||(s[7]=e=>f.pagination=e),"hide-bottom":""},{loading:(0,a.k6)((()=>[(0,a.bF)(S,{showing:"",color:"primary",class:"loading"})])),"body-cell-leer":(0,a.k6)((e=>[(0,a.bF)(C,{props:e},{default:(0,a.k6)((()=>[(0,a.bF)(y,{dense:"",modelValue:e.row.acciones[0].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[0].bpermisos=s,s=>w.updatePermisos(e.row.acciones[0])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])),_:2},1032,["props"])])),"body-cell-crear":(0,a.k6)((e=>[(0,a.bF)(C,{props:e},{default:(0,a.k6)((()=>[(0,a.bF)(y,{dense:"",modelValue:e.row.acciones[1].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[1].bpermisos=s,s=>w.updatePermisos(e.row.acciones[1])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])),_:2},1032,["props"])])),"body-cell-editar":(0,a.k6)((e=>[(0,a.bF)(C,{props:e},{default:(0,a.k6)((()=>[(0,a.bF)(y,{dense:"",modelValue:e.row.acciones[2].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[2].bpermisos=s,s=>w.updatePermisos(e.row.acciones[2])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])),_:2},1032,["props"])])),"body-cell-eliminar":(0,a.k6)((e=>[(0,a.bF)(C,{props:e},{default:(0,a.k6)((()=>[(0,a.bF)(y,{dense:"",modelValue:e.row.acciones[3].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[3].bpermisos=s,s=>w.updatePermisos(e.row.acciones[3])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])),_:2},1032,["props"])])),"body-cell-action":(0,a.k6)((e=>[(0,a.bF)(C,{props:e},{default:(0,a.k6)((()=>[e.row.acciones[4]?((0,a.uX)(),(0,a.Wv)(A,{key:0,dense:"",round:"",flat:"",color:"primary",icon:"settings",onClick:s=>{this.form.acciones=e.row.acciones,this.permisosForm=!0}},null,8,["onClick"])):(0,a.Q3)("",!0)])),_:2},1032,["props"])])),item:(0,a.k6)((e=>[(0,a.Lk)("div",{class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition",style:(0,t.Tr)(e.selected?"transform: scale(0.95);":"")},[(0,a.bF)(V,{class:(0,t.C4)(e.selected?"bg-grey-2":"")},{default:(0,a.k6)((()=>[(0,a.bF)(Q,{dense:""},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cols,(s=>((0,a.uX)(),(0,a.Wv)(v,{key:s.name},{default:(0,a.k6)((()=>[(0,a.bF)(F,null,{default:(0,a.k6)((()=>[(0,a.bF)(I,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,t.v_)(s.label),1)])),_:2},1024)])),_:2},1024),(0,a.bF)(F,{side:"",class:"itemMovilSide"},{default:(0,a.k6)((()=>["label"===s.name?((0,a.uX)(),(0,a.Wv)(I,{key:0},{default:(0,a.k6)((()=>[(0,a.eW)((0,t.v_)(e.row.label),1)])),_:2},1024)):(0,a.Q3)("",!0)])),_:2},1024),(0,a.bF)(F,{side:""},{default:(0,a.k6)((()=>["leer"===s.name?((0,a.uX)(),(0,a.Wv)(y,{key:0,dense:"",modelValue:e.row.acciones[0].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[0].bpermisos=s,s=>w.updatePermisos(e.row.acciones[0])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])):(0,a.Q3)("",!0)])),_:2},1024),(0,a.bF)(F,{side:""},{default:(0,a.k6)((()=>["crear"===s.name?((0,a.uX)(),(0,a.Wv)(y,{key:0,dense:"",modelValue:e.row.acciones[1].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[1].bpermisos=s,s=>w.updatePermisos(e.row.acciones[1])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])):(0,a.Q3)("",!0)])),_:2},1024),(0,a.bF)(F,{side:""},{default:(0,a.k6)((()=>["editar"===s.name?((0,a.uX)(),(0,a.Wv)(y,{key:0,dense:"",modelValue:e.row.acciones[2].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[2].bpermisos=s,s=>w.updatePermisos(e.row.acciones[2])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])):(0,a.Q3)("",!0)])),_:2},1024),(0,a.bF)(F,{side:""},{default:(0,a.k6)((()=>["eliminar"===s.name?((0,a.uX)(),(0,a.Wv)(y,{key:0,dense:"",modelValue:e.row.acciones[3].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[3].bpermisos=s,s=>w.updatePermisos(e.row.acciones[3])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])):(0,a.Q3)("",!0)])),_:2},1024),(0,a.bF)(F,{side:""},{default:(0,a.k6)((()=>["action"===s.name&&e.row.acciones[4]?((0,a.uX)(),(0,a.Wv)(A,{key:0,dense:"",round:"",flat:"",color:"primary",icon:"settings",onClick:s=>{this.form.acciones=e.row.acciones,this.permisosForm=!0}},null,8,["onClick"])):(0,a.Q3)("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1032,["class"])],4)])),_:1},8,["rows","columns","loading","separator","grid","pagination"])])])]),(0,a.bF)($,{ref:"methods",onSetDataMenus:w.setDataMenus,onSetDataRoles:w.setDataRoles,onSetDataInit:w.setDataInit,onSetDataPermisos:w.setDataPermisos},null,8,["onSetDataMenus","onSetDataRoles","onSetDataInit","onSetDataPermisos"])])),_:1})}o(10239);var f=o(38734),w=o(80660),y=o(45022),A=o(93899);const x={components:{methods:A.A},name:"Permisologia",data(){return{columnsPermisos:[{name:"label",label:"Menu",field:"label",align:"left",sortable:!0},{name:"leer",label:"Leer",align:"center"},{name:"crear",label:"Crear",align:"center"},{name:"editar",label:"Editar",align:"center"},{name:"eliminar",label:"Eliminar",align:"center"},{name:"action",label:"Otros",align:"center"}],form:{acciones:[]},pagination:{rowsPerPage:200,sortBy:"label",descending:!1},permisos:[],agencias:[],agenciasSelected:[],roles:[],rolesPermisos:[],objetos:[],rolesPermisosSelected:[],selected:[],selectedAgencia:[],selectedRol:[],rpermisos:[],menus:[]}},setup(){return{separator:(0,f.KR)("vertical"),permisosForm:(0,f.KR)(!1),loading:(0,f.KR)(!1)}},mounted(){this.$emit("changeTitle","SCEN - Seguridad - Permisologia",""),this.getData("/agencias","setDataInit","agencias"),this.$refs.methods.getData("/rpermisos","setDataPermisos","rpermisos",{headers:{rol:y.A.getItem("tokenTraducido").usuario.roles.id,menu:"permisologia"}})},methods:{filterArray(e,s,o,a,t){s(""!==e?()=>{const s=e.toUpperCase();for(var i=[],l=0;l<=this[a].length-1;l++)if(this[a][l][t].indexOf(s)>-1&&i.push(this[a][l]),l==this[a].length-1){this[o]=i;break}}:()=>{this[o]=this[a]})},allowOption(e){return this.rpermisos.findIndex((s=>s.acciones.accion==e))<0},setDataPermisos(e,s){this[s]=e,this.rpermisos.findIndex((e=>1==e.acciones.accion))<0&&this.$router.push("/error403")},setDataInit(e,s){this.loading=!0,this[s]=e.data,this.selectedAgencia=this.agencias[0],w.api.get("/roles",{headers:{Authorization:`Bearer ${y.A.getItem("token")}`,agencia:this.agencias[0].id}}).then((e=>{this.selectedRol=e.data[0],this.rolesPermisos=e.data,this.getData("/menus","setDataMenus","menus",{headers:{rol:this.selectedRol.id}})}))},setData(e,s){this[s]=e},getData(e,s,o,a){this.$refs.methods.getData(e,s,o,a)},setDataRoles(e,s){this[s]=e,this.selectedRol=this.roles[0]},setDataMenus(e,s){this[s]=e;for(let o=0;o<this.menus.length;o++)for(let e=0;e<this.menus[o].acciones.length;e++)this.menus[o].acciones[e].rpermisos.length>0?this.menus[o].acciones[e].bpermisos=!0:this.menus[o].acciones[e].bpermisos=!1;this.loading=!1},updatePermisos(e){e.bpermisos?w.api.post("/rpermisos",{cod_rol:this.selectedRol.id,cod_menu_accion:e.id},{headers:{Authorization:`Bearer ${y.A.getItem("token")}`}}).then((s=>{this.$q.notify({message:"Agregado exitosamente",color:"green"}),e.rpermisos[0]=s.data})):this.$refs.methods.deleteData(`/rpermisos/${e.rpermisos[0].id}`,"getData")}}};var V=o(12807),D=o(77716),F=o(82156),v=o(23316),_=o(44189),P=o(80460),S=o(56384),C=o(94940),I=o(90124),Q=o(25173),U=o(50492),$=o(84191),q=o(39035),L=o(45262),E=o(53999),R=o(13796),O=o(88672),X=o(98582),W=o.n(X);const M=(0,V.A)(x,[["render",k]]),B=M;W()(x,"components",{QPage:D.A,QDialog:F.A,QCard:v.A,QCardSection:_.A,QCheckbox:P.A,QBtn:S.A,QSelect:C.A,QItem:I.A,QItemSection:Q.A,QIcon:U.A,QTable:$.A,QInnerLoading:q.A,QTd:L.A,QList:E.A,QItemLabel:R.A}),W()(x,"directives",{ClosePopup:O.A})}}]);