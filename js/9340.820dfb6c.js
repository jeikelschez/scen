"use strict";(globalThis["webpackChunktest"]=globalThis["webpackChunktest"]||[]).push([[9340],{23759:(e,s,o)=>{function t(e,s,o,t,a,i){return null}o.d(s,{Z:()=>c});var a=o(80589),i=o(5474),l=o(48825);const n={setup(){const e=(0,l.Z)();return{errorDelServidor(){this.$emit("resetLoading"),e.notify({message:this.error,color:"red"})},añadidoConExito(){e.notify({message:"Agregado exitosamente",color:"green"})},editadoConExito(){e.notify({message:"Editado exitosamente",color:"green"})},eliminadoConExito(){e.notify({message:"Eliminado exitosamente",color:"green"})}}},methods:{getData:function(e,s,o,t={headers:{}}){t.headers.Authorization=`Bearer ${a.Z.getItem("token")}`,i.api.get(e,t).then((e=>{this.$emit(s,e.data,o)})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor(),this.$emit("resetLoading")}))},createData:function(e,s,o,t={headers:{}}){t.headers.Authorization=`Bearer ${a.Z.getItem("token")}`,i.api.post(e,s,t).then((e=>{(e.status=200)&&(this.$emit(o),this.añadidoConExito())})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor(),this.$emit("resetLoading")}))},putData:function(e,s,o,t={headers:{}}){t.headers.Authorization=`Bearer ${a.Z.getItem("token")}`,i.api.put(e,s,t).then((e=>{(e.status=200)&&(this.$emit(o),this.editadoConExito())})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor()}))},deleteData:function(e,s,o={headers:{}}){o.headers.Authorization=`Bearer ${a.Z.getItem("token")}`,i.api["delete"](e,o).then((e=>{(e.status=200)&&(this.$emit(s),this.eliminadoConExito())})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor(),this.$emit("resetLoading")}))},login:function(e,s,o,t={headers:{}}){t.headers.Authorization=`Bearer ${a.Z.getItem("token")}`,i.api.post(e,s,t).then((e=>{(e.status=200)&&this.$emit(o,e.data)})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor()}))}}};var r=o(74260);const d=(0,r.Z)(n,[["render",t]]),c=d},79340:(e,s,o)=>{o.r(s),o.d(s,{default:()=>H});var t=o(83673),a=o(62323);const i={class:"row items-center"},l={key:0,class:"col-md-9 col-sm-10 col-xs-9"},n={class:"titleCheckbox"},r={key:1,class:"col-md-2 col-sm-2 col-xs-3",style:{"text-align":"right"}},d={class:"row justify-center items-center",style:{"margin-bottom":"10px","margin-top":"40px"}},c={class:"q-pa-sm justify-center"},m={class:"q-pa-md row justify-end"},u=(0,t._)("div",{class:"col-md-3 col-xl-3 col-lg-3 col-xs-12 col-sm-12 movilTitle",style:{"align-self":"center","text-align":"center"}},[(0,t._)("p",{style:{"font-size":"20px"},class:"text-secondary"},[(0,t._)("strong",null,"SEGURIDAD - PERMISOLOGÍA")])],-1),p={class:"col-md-6 col-xl-6 col-lg-6 col-xs-12 col-sm-6 cardMargin selectMobile",style:{"align-self":"center","text-align":"center"}},g=(0,t.Uk)(" Sin resultados "),h={class:"col-md-6 col-xl-6 col-lg-6 col-xs-12 col-sm-6 selectMobile",style:{"align-self":"center","text-align":"center"}},w=(0,t.Uk)(" Sin resultados "),b={class:"q-pa-md q-gutter-y-md"};function f(e,s,o,f,D,y){const k=(0,t.up)("q-checkbox"),V=(0,t.up)("q-btn"),_=(0,t.up)("q-card-section"),x=(0,t.up)("q-card"),P=(0,t.up)("q-dialog"),q=(0,t.up)("q-item-section"),W=(0,t.up)("q-item"),v=(0,t.up)("q-icon"),S=(0,t.up)("q-select"),Z=(0,t.up)("q-inner-loading"),U=(0,t.up)("q-td"),C=(0,t.up)("q-item-label"),I=(0,t.up)("q-list"),$=(0,t.up)("q-table"),A=(0,t.up)("methods"),R=(0,t.up)("q-page"),Q=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(R,{class:"pagina q-pa-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(P,{modelValue:f.permisosForm,"onUpdate:modelValue":s[0]||(s[0]=e=>f.permisosForm=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{class:"q-pa-md",bordered:"",style:{width:"900px","max-width":"80vw"}},{default:(0,t.w5)((()=>[(0,t.Wm)(_,null,{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(this.form.acciones,((e,s)=>((0,t.wg)(),(0,t.iD)("div",i,[s>3?((0,t.wg)(),(0,t.iD)("div",l,[(0,t._)("p",n,(0,a.zw)(e.descripcion),1)])):(0,t.kq)("",!0),s>3?((0,t.wg)(),(0,t.iD)("div",r,[(0,t.Wm)(k,{modelValue:e.bpermisos,"onUpdate:modelValue":[s=>e.bpermisos=s,s=>y.updatePermisos(e)],class:"checkboxItem",disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])):(0,t.kq)("",!0)])))),256)),(0,t._)("div",d,[(0,t.wy)((0,t.Wm)(V,{label:"Cerrar",color:"primary",class:"col-md-5 col-sm-5 col-xs-12",icon:"close"},null,512),[[Q]])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t._)("div",c,[(0,t._)("div",m,[u,(0,t._)("div",p,[(0,t.Wm)(S,{rounded:"","transition-show":"flip-up","transition-hide":"flip-down",options:D.agenciasSelected,onFilter:s[1]||(s[1]=(e,s,o)=>y.filterArray(e,s,o,"agenciasSelected","agencias","nb_agencia")),"use-input":"","hide-selected":"","fill-input":"",dense:"","input-debounce":"0","option-label":"nb_agencia","option-value":"id",modelValue:D.selectedAgencia,"onUpdate:modelValue":[s[2]||(s[2]=e=>D.selectedAgencia=e),s[3]||(s[3]=e=>{y.getData("/roles","setDataRoles","rolesPermisos",{headers:{agencia:this.selectedAgencia.id}}),this.menus=[]})],outlined:"",standout:"",label:"Escoge una Agencia"},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(W,null,{default:(0,t.w5)((()=>[(0,t.Wm)(q,{class:"text-grey"},{default:(0,t.w5)((()=>[g])),_:1})])),_:1})])),prepend:(0,t.w5)((()=>[(0,t.Wm)(v,{name:"search"})])),_:1},8,["options","modelValue"])]),(0,t._)("div",h,[(0,t.Wm)(S,{rounded:"","transition-show":"flip-up","transition-hide":"flip-down",options:D.rolesPermisosSelected,onFilter:s[4]||(s[4]=(e,s,o)=>y.filterArray(e,s,o,"rolesPermisosSelected","rolesPermisos","descripcion")),"use-input":"","hide-selected":"","fill-input":"",dense:"","input-debounce":"0","option-label":"descripcion","option-value":"id",modelValue:D.selectedRol,"onUpdate:modelValue":[s[5]||(s[5]=e=>D.selectedRol=e),s[6]||(s[6]=e=>{y.getData("/menus","setDataMenus","menus",{headers:{rol:this.selectedRol.id}}),this.menus=[]})],outlined:"",standout:"",label:"Escoge un Rol"},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(W,null,{default:(0,t.w5)((()=>[(0,t.Wm)(q,{class:"text-grey"},{default:(0,t.w5)((()=>[w])),_:1})])),_:1})])),prepend:(0,t.w5)((()=>[(0,t.Wm)(v,{name:"search"})])),_:1},8,["options","modelValue"])])]),(0,t._)("div",b,[(0,t.Wm)($,{rows:D.menus,"row-key":"id",columns:D.columnsPermisos,loading:f.loading,"binary-state-sort":"",separator:f.separator,filter:f.filterPermisos,style:{width:"100%"},grid:e.$q.screen.xs,pagination:f.pagination,"onUpdate:pagination":s[7]||(s[7]=e=>f.pagination=e),"hide-bottom":""},{loading:(0,t.w5)((()=>[(0,t.Wm)(Z,{showing:"",color:"primary"})])),"body-cell-leer":(0,t.w5)((e=>[(0,t.Wm)(U,{props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{dense:"",modelValue:e.row.acciones[0].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[0].bpermisos=s,s=>y.updatePermisos(e.row.acciones[0])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])),_:2},1032,["props"])])),"body-cell-crear":(0,t.w5)((e=>[(0,t.Wm)(U,{props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{dense:"",modelValue:e.row.acciones[1].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[1].bpermisos=s,s=>y.updatePermisos(e.row.acciones[1])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])),_:2},1032,["props"])])),"body-cell-editar":(0,t.w5)((e=>[(0,t.Wm)(U,{props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{dense:"",modelValue:e.row.acciones[2].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[2].bpermisos=s,s=>y.updatePermisos(e.row.acciones[2])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])),_:2},1032,["props"])])),"body-cell-eliminar":(0,t.w5)((e=>[(0,t.Wm)(U,{props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{dense:"",modelValue:e.row.acciones[3].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[3].bpermisos=s,s=>y.updatePermisos(e.row.acciones[3])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])),_:2},1032,["props"])])),"body-cell-action":(0,t.w5)((e=>[(0,t.Wm)(U,{props:e},{default:(0,t.w5)((()=>[e.row.acciones[4]?((0,t.wg)(),(0,t.j4)(V,{key:0,dense:"",round:"",flat:"",color:"primary",icon:"settings",onClick:s=>{this.form.acciones=e.row.acciones,this.permisosForm=!0}},null,8,["onClick"])):(0,t.kq)("",!0)])),_:2},1032,["props"])])),item:(0,t.w5)((e=>[(0,t._)("div",{class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition",style:(0,a.j5)(e.selected?"transform: scale(0.95);":"")},[(0,t.Wm)(x,{class:(0,a.C_)(e.selected?"bg-grey-2":"")},{default:(0,t.w5)((()=>[(0,t.Wm)(I,{dense:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.cols,(s=>((0,t.wg)(),(0,t.j4)(W,{key:s.name},{default:(0,t.w5)((()=>[(0,t.Wm)(q,null,{default:(0,t.w5)((()=>[(0,t.Wm)(C,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,a.zw)(s.label),1)])),_:2},1024)])),_:2},1024),(0,t.Wm)(q,{side:"",class:"itemMovilSide"},{default:(0,t.w5)((()=>["label"===s.name?((0,t.wg)(),(0,t.j4)(C,{key:0},{default:(0,t.w5)((()=>[(0,t.Uk)((0,a.zw)(e.row.label),1)])),_:2},1024)):(0,t.kq)("",!0)])),_:2},1024),(0,t.Wm)(q,{side:""},{default:(0,t.w5)((()=>["leer"===s.name?((0,t.wg)(),(0,t.j4)(k,{key:0,dense:"",modelValue:e.row.acciones[0].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[0].bpermisos=s,s=>y.updatePermisos(e.row.acciones[0])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])):(0,t.kq)("",!0)])),_:2},1024),(0,t.Wm)(q,{side:""},{default:(0,t.w5)((()=>["crear"===s.name?((0,t.wg)(),(0,t.j4)(k,{key:0,dense:"",modelValue:e.row.acciones[1].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[1].bpermisos=s,s=>y.updatePermisos(e.row.acciones[1])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])):(0,t.kq)("",!0)])),_:2},1024),(0,t.Wm)(q,{side:""},{default:(0,t.w5)((()=>["editar"===s.name?((0,t.wg)(),(0,t.j4)(k,{key:0,dense:"",modelValue:e.row.acciones[2].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[2].bpermisos=s,s=>y.updatePermisos(e.row.acciones[2])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])):(0,t.kq)("",!0)])),_:2},1024),(0,t.Wm)(q,{side:""},{default:(0,t.w5)((()=>["eliminar"===s.name?((0,t.wg)(),(0,t.j4)(k,{key:0,dense:"",modelValue:e.row.acciones[3].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[3].bpermisos=s,s=>y.updatePermisos(e.row.acciones[3])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])):(0,t.kq)("",!0)])),_:2},1024),(0,t.Wm)(q,{side:""},{default:(0,t.w5)((()=>["action"===s.name&&e.row.acciones[4]?((0,t.wg)(),(0,t.j4)(V,{key:0,dense:"",round:"",flat:"",color:"primary",icon:"settings",onClick:s=>{this.form.acciones=e.row.acciones,this.permisosForm=!0}},null,8,["onClick"])):(0,t.kq)("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1032,["class"])],4)])),_:1},8,["rows","columns","loading","separator","filter","grid","pagination"])])]),(0,t.Wm)(A,{ref:"methods",onSetDataMenus:y.setDataMenus,onSetDataRoles:y.setDataRoles,onResetLoading:y.resetLoading,onSetDataInit:y.setDataInit,onSetDataPermisos:y.setDataPermisos},null,8,["onSetDataMenus","onSetDataRoles","onResetLoading","onSetDataInit","onSetDataPermisos"])])),_:1})}var D=o(61959),y=o(5474),k=o(48825),V=o(80589),_=o(23759);const x={components:{methods:_.Z},name:"Permisologia",data(){return{columnsPermisos:[{name:"label",label:"Menu",field:"label",align:"left",sortable:!0,required:!0},{name:"leer",label:"Leer",align:"center"},{name:"crear",label:"Crear",align:"center"},{name:"editar",label:"Editar",align:"center"},{name:"eliminar",label:"Eliminar",align:"center"},{name:"action",label:"Otros",align:"center",sortable:!0,required:!0}],permisos:[],agencias:[],agenciasSelected:[],roles:[],rolesPermisos:[],form:{acciones:[]},objetos:[],rolesPermisosSelected:[],selected:[],selectedAgencia:[],selectedRol:[],rpermisos:[],menus:[],error:"",items:0}},setup(){(0,k.Z)(),(0,D.iH)({sortBy:"desc",descending:!1,page:1,control:0,rowsPerPage:100});return{axiosConfig:{headers:{Authorization:""}},pagination:(0,D.iH)({rowsPerPage:100}),separator:(0,D.iH)("vertical"),reglasCodigo:[e=>null!==e&&""!==e||"Por favor escribe algo",e=>e.length<25||"Deben ser máximo 25 caracteres",e=>e.length>3||"Deben ser minimo 3 caracteres"],permisosForm:(0,D.iH)(!1),loading:(0,D.iH)(!1),filterPermisos:(0,D.iH)("")}},mounted(){this.$emit("changeTitle","SCEN - Seguridad - Permisologia",""),this.loading=!0,this.getData("/agencias","setDataInit","agencias"),this.$refs.methods.getData("/rpermisos","setDataPermisos","rpermisos",{headers:{rol:V.Z.getItem("tokenTraducido").usuario.roles.id,menu:"permisologia"}})},methods:{filterArray(e,s,o,t,a,i){s(""!==e?()=>{const s=e.toUpperCase();for(var o=[],l=0;l<=this[a].length-1;l++)if(this[a][l][i].indexOf(s)>-1&&o.push(this[a][l]),l==this[a].length-1){this[t]=o;break}}:()=>{this[t]=this[a]})},resetLoading(){this.loading=!1},reglasInputs(e){if(null===e)return"Debes Seleccionar Algo"},allowOption(e){return this.rpermisos.findIndex((s=>s.acciones.accion==e))<0},setDataPermisos(e,s){this[s]=e,this.rpermisos.findIndex((e=>1==e.acciones.accion))<0&&this.$router.push("/error403")},setDataInit(e,s){this[s]=e.data,this.selectedAgencia=this.agencias[0],y.api.get("/roles",{headers:{Authorization:`Bearer ${V.Z.getItem("token")}`,agencia:this.agencias[0].id}}).then((e=>{this.selectedRol=e.data[0],this.rolesPermisos=e.data,this.getData("/menus","setDataMenus","menus",{headers:{rol:this.selectedRol.id}})})),this.loading=!1},setData(e,s){this[s]=e},getData(e,s,o,t){this.$refs.methods.getData(e,s,o,t)},setDataRoles(e,s){this[s]=e,this.selectedRol=this.roles[0]},setDataMenus(e,s){this[s]=e;for(let o=0;o<this.menus.length;o++)for(let e=0;e<this.menus[o].acciones.length;e++)this.menus[o].acciones[e].rpermisos.length>0?this.menus[o].acciones[e].bpermisos=!0:this.menus[o].acciones[e].bpermisos=!1},updatePermisos(e){e.bpermisos?y.api.post("/rpermisos",{cod_rol:this.selectedRol.id,cod_menu_accion:e.id},{headers:{Authorization:`Bearer ${V.Z.getItem("token")}`}}).then((s=>{this.$q.notify({message:"Agregado exitosamente",color:"green"}),e.rpermisos[0]=s.data})):this.$refs.methods.deleteData(`/rpermisos/${e.rpermisos[0].id}`,"getData")}}};var P=o(74260),q=o(24379),W=o(46778),v=o(10151),S=o(25589),Z=o(65735),U=o(48240),C=o(72448),I=o(83414),$=o(52035),A=o(24554),R=o(17352),Q=o(66941),E=o(83884),j=o(27011),O=o(2350),L=o(60677),z=o(7518),M=o.n(z);const B=(0,P.Z)(x,[["render",f]]),H=B;M()(x,"components",{QPage:q.Z,QDialog:W.Z,QCard:v.Z,QCardSection:S.Z,QCheckbox:Z.Z,QBtn:U.Z,QSelect:C.Z,QItem:I.Z,QItemSection:$.Z,QIcon:A.Z,QTable:R.Z,QInnerLoading:Q.Z,QTd:E.Z,QList:j.Z,QItemLabel:O.Z}),M()(x,"directives",{ClosePopup:L.Z})}}]);