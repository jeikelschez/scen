"use strict";(globalThis["webpackChunktest"]=globalThis["webpackChunktest"]||[]).push([[9319],{3759:(e,s,o)=>{function a(e,s,o,a,t,i){return null}o.d(s,{Z:()=>c});var t=o(589),i=o(5474),l=o(8825);const n={setup(){const e=(0,l.Z)();return{errorDelServidor(){this.$emit("resetLoading"),e.notify({message:this.error,color:"red"})},añadidoConExito(){e.notify({message:"Agregado exitosamente",color:"green"})},editadoConExito(){e.notify({message:"Editado exitosamente",color:"green"})},eliminadoConExito(){e.notify({message:"Eliminado exitosamente",color:"green"})}}},methods:{getData:function(e,s,o,a={headers:{}}){a.headers.Authorization=`Bearer ${t.Z.getItem("token")}`,i.api.get(e,a).then((e=>{this.$emit(s,e.data,o)})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor(),this.$emit("resetLoading")}))},createData:function(e,s,o,a={headers:{}}){a.headers.Authorization=`Bearer ${t.Z.getItem("token")}`,i.api.post(e,s,a).then((e=>{(e.status=200)&&(this.$emit(o),this.añadidoConExito())})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor(),this.$emit("resetLoading")}))},putData:function(e,s,o,a={headers:{}}){a.headers.Authorization=`Bearer ${t.Z.getItem("token")}`,i.api.put(e,s,a).then((e=>{(e.status=200)&&(this.$emit(o),this.editadoConExito())})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor()}))},deleteData:function(e,s,o={headers:{}}){o.headers.Authorization=`Bearer ${t.Z.getItem("token")}`,i.api.delete(e,o).then((e=>{(e.status=200)&&(this.$emit(s),this.eliminadoConExito())})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor(),this.$emit("resetLoading")}))},login:function(e,s,o,a={headers:{}}){a.headers.Authorization=`Bearer ${t.Z.getItem("token")}`,i.api.post(e,s,a).then((e=>{(e.status=200)&&this.$emit(o,e.data)})).catch((e=>{e.response&&(this.error=e.response.data.message),this.errorDelServidor()}))}}};var r=o(4260);const d=(0,r.Z)(n,[["render",a]]),c=d},9319:(e,s,o)=>{o.r(s),o.d(s,{default:()=>F});var a=o(3673),t=o(2323);const i={class:"row items-center"},l={key:0,class:"col-md-9 col-sm-10 col-xs-9"},n={class:"titleCheckbox"},r={key:1,class:"col-md-2 col-sm-2 col-xs-3",style:{"text-align":"right"}},d={class:"row justify-center items-center",style:{"margin-bottom":"10px","margin-top":"40px"}},c={class:"row q-pa-sm justify-center"},m={class:"col-md-12 col-xl-12 col-lg-12 col-xs-12 col-sm-12"},p={class:"q-pa-md row",style:{"margin-top":"2px"}},u=(0,a._)("div",{class:"col-md-3 col-xl-3 col-lg-3 col-xs-12 col-sm-12 movilTitle",style:{"align-self":"center","text-align":"center"}},[(0,a._)("p",{style:{"font-size":"20px"},class:"text-secondary"},[(0,a._)("strong",null,"SEGURIDAD - PERMISOLOGÍA")])],-1),h={class:"col-md-6 col-xl-6 col-lg-6 col-xs-12 col-sm-6 cardMargin selectMobile",style:{"align-self":"center","text-align":"center"}},g=(0,a.Uk)(" Sin resultados "),w={class:"col-md-6 col-xl-6 col-lg-6 col-xs-12 col-sm-6 selectMobile",style:{"align-self":"center","text-align":"center"}},b=(0,a.Uk)(" Sin resultados "),f={class:"q-pa-md my-card row",bordered:"",flat:"",style:{"margin-top":"2px"}};function y(e,s,o,y,D,_){const k=(0,a.up)("q-checkbox"),x=(0,a.up)("q-btn"),V=(0,a.up)("q-card-section"),W=(0,a.up)("q-card"),q=(0,a.up)("q-dialog"),v=(0,a.up)("q-item-section"),P=(0,a.up)("q-item"),S=(0,a.up)("q-icon"),Z=(0,a.up)("q-select"),U=(0,a.up)("q-inner-loading"),$=(0,a.up)("q-td"),I=(0,a.up)("q-item-label"),C=(0,a.up)("q-list"),A=(0,a.up)("q-table"),Q=(0,a.up)("methods"),R=(0,a.up)("q-page"),E=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(R,{class:"pagina q-pa-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(q,{modelValue:y.permisosForm,"onUpdate:modelValue":s[0]||(s[0]=e=>y.permisosForm=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{class:"q-pa-md",bordered:"",style:{width:"900px","max-width":"80vw"}},{default:(0,a.w5)((()=>[(0,a.Wm)(V,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(this.form.acciones,((e,s)=>((0,a.wg)(),(0,a.iD)("div",i,[s>3?((0,a.wg)(),(0,a.iD)("div",l,[(0,a._)("p",n,(0,t.zw)(e.descripcion),1)])):(0,a.kq)("",!0),s>3?((0,a.wg)(),(0,a.iD)("div",r,[(0,a.Wm)(k,{modelValue:e.bpermisos,"onUpdate:modelValue":[s=>e.bpermisos=s,s=>_.updatePermisos(e)],class:"checkboxItem",disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])):(0,a.kq)("",!0)])))),256)),(0,a._)("div",d,[(0,a.wy)((0,a.Wm)(x,{label:"Cerrar",color:"primary",class:"col-md-5 col-sm-5 col-xs-12",icon:"close"},null,512),[[E]])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a._)("div",c,[(0,a._)("div",m,[(0,a._)("div",p,[u,(0,a._)("div",h,[(0,a.Wm)(Z,{rounded:"","transition-show":"flip-up","transition-hide":"flip-down",options:D.agenciasSelected,onFilter:s[1]||(s[1]=(e,s)=>_.filterArray(e,s,"agenciasSelected","agencias","nb_agencia")),"use-input":"","hide-selected":"","fill-input":"",dense:"","input-debounce":"0","option-label":"nb_agencia","option-value":"id",modelValue:D.selectedAgencia,"onUpdate:modelValue":[s[2]||(s[2]=e=>D.selectedAgencia=e),s[3]||(s[3]=e=>{_.getData("/roles","setDataRoles","rolesPermisos",{headers:{agencia:this.selectedAgencia.id}}),this.menus=[]})],outlined:"",standout:"",label:"Escoge una Agencia"},{"no-option":(0,a.w5)((()=>[(0,a.Wm)(P,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,{class:"text-grey"},{default:(0,a.w5)((()=>[g])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[(0,a.Wm)(S,{name:"search"})])),_:1},8,["options","modelValue"])]),(0,a._)("div",w,[(0,a.Wm)(Z,{rounded:"","transition-show":"flip-up","transition-hide":"flip-down",options:D.rolesPermisosSelected,onFilter:s[4]||(s[4]=(e,s)=>_.filterArray(e,s,"rolesPermisosSelected","rolesPermisos","descripcion")),"use-input":"","hide-selected":"","fill-input":"",dense:"","input-debounce":"0","option-label":"descripcion","option-value":"id",modelValue:D.selectedRol,"onUpdate:modelValue":[s[5]||(s[5]=e=>D.selectedRol=e),s[6]||(s[6]=e=>{_.getData("/menus","setDataMenus","menus",{headers:{rol:this.selectedRol.id}}),this.menus=[]})],outlined:"",standout:"",label:"Escoge un Rol"},{"no-option":(0,a.w5)((()=>[(0,a.Wm)(P,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,{class:"text-grey"},{default:(0,a.w5)((()=>[b])),_:1})])),_:1})])),prepend:(0,a.w5)((()=>[(0,a.Wm)(S,{name:"search"})])),_:1},8,["options","modelValue"])])]),(0,a._)("div",f,[(0,a.Wm)(A,{rows:D.menus,"row-key":"id",columns:D.columnsPermisos,loading:y.loading,"binary-state-sort":"",separator:y.separator,style:{width:"100%"},grid:e.$q.screen.xs,pagination:D.pagination,"onUpdate:pagination":s[7]||(s[7]=e=>D.pagination=e),"hide-bottom":""},{loading:(0,a.w5)((()=>[(0,a.Wm)(U,{showing:"",color:"primary",class:"loading"})])),"body-cell-leer":(0,a.w5)((e=>[(0,a.Wm)($,{props:e},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{dense:"",modelValue:e.row.acciones[0].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[0].bpermisos=s,s=>_.updatePermisos(e.row.acciones[0])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])),_:2},1032,["props"])])),"body-cell-crear":(0,a.w5)((e=>[(0,a.Wm)($,{props:e},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{dense:"",modelValue:e.row.acciones[1].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[1].bpermisos=s,s=>_.updatePermisos(e.row.acciones[1])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])),_:2},1032,["props"])])),"body-cell-editar":(0,a.w5)((e=>[(0,a.Wm)($,{props:e},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{dense:"",modelValue:e.row.acciones[2].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[2].bpermisos=s,s=>_.updatePermisos(e.row.acciones[2])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])),_:2},1032,["props"])])),"body-cell-eliminar":(0,a.w5)((e=>[(0,a.Wm)($,{props:e},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{dense:"",modelValue:e.row.acciones[3].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[3].bpermisos=s,s=>_.updatePermisos(e.row.acciones[3])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])])),_:2},1032,["props"])])),"body-cell-action":(0,a.w5)((e=>[(0,a.Wm)($,{props:e},{default:(0,a.w5)((()=>[e.row.acciones[4]?((0,a.wg)(),(0,a.j4)(x,{key:0,dense:"",round:"",flat:"",color:"primary",icon:"settings",onClick:s=>{this.form.acciones=e.row.acciones,this.permisosForm=!0}},null,8,["onClick"])):(0,a.kq)("",!0)])),_:2},1032,["props"])])),item:(0,a.w5)((e=>[(0,a._)("div",{class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition",style:(0,t.j5)(e.selected?"transform: scale(0.95);":"")},[(0,a.Wm)(W,{class:(0,t.C_)(e.selected?"bg-grey-2":"")},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{dense:""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cols,(s=>((0,a.wg)(),(0,a.j4)(P,{key:s.name},{default:(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Wm)(I,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,t.zw)(s.label),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(v,{side:"",class:"itemMovilSide"},{default:(0,a.w5)((()=>["label"===s.name?((0,a.wg)(),(0,a.j4)(I,{key:0},{default:(0,a.w5)((()=>[(0,a.Uk)((0,t.zw)(e.row.label),1)])),_:2},1024)):(0,a.kq)("",!0)])),_:2},1024),(0,a.Wm)(v,{side:""},{default:(0,a.w5)((()=>["leer"===s.name?((0,a.wg)(),(0,a.j4)(k,{key:0,dense:"",modelValue:e.row.acciones[0].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[0].bpermisos=s,s=>_.updatePermisos(e.row.acciones[0])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])):(0,a.kq)("",!0)])),_:2},1024),(0,a.Wm)(v,{side:""},{default:(0,a.w5)((()=>["crear"===s.name?((0,a.wg)(),(0,a.j4)(k,{key:0,dense:"",modelValue:e.row.acciones[1].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[1].bpermisos=s,s=>_.updatePermisos(e.row.acciones[1])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])):(0,a.kq)("",!0)])),_:2},1024),(0,a.Wm)(v,{side:""},{default:(0,a.w5)((()=>["editar"===s.name?((0,a.wg)(),(0,a.j4)(k,{key:0,dense:"",modelValue:e.row.acciones[2].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[2].bpermisos=s,s=>_.updatePermisos(e.row.acciones[2])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])):(0,a.kq)("",!0)])),_:2},1024),(0,a.Wm)(v,{side:""},{default:(0,a.w5)((()=>["eliminar"===s.name?((0,a.wg)(),(0,a.j4)(k,{key:0,dense:"",modelValue:e.row.acciones[3].bpermisos,"onUpdate:modelValue":[s=>e.row.acciones[3].bpermisos=s,s=>_.updatePermisos(e.row.acciones[3])],disable:this.allowOption(2)},null,8,["modelValue","onUpdate:modelValue","disable"])):(0,a.kq)("",!0)])),_:2},1024),(0,a.Wm)(v,{side:""},{default:(0,a.w5)((()=>["action"===s.name&&e.row.acciones[4]?((0,a.wg)(),(0,a.j4)(x,{key:0,dense:"",round:"",flat:"",color:"primary",icon:"settings",onClick:s=>{this.form.acciones=e.row.acciones,this.permisosForm=!0}},null,8,["onClick"])):(0,a.kq)("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1032,["class"])],4)])),_:1},8,["rows","columns","loading","separator","grid","pagination"])])])]),(0,a.Wm)(Q,{ref:"methods",onSetDataMenus:_.setDataMenus,onSetDataRoles:_.setDataRoles,onSetDataInit:_.setDataInit,onSetDataPermisos:_.setDataPermisos},null,8,["onSetDataMenus","onSetDataRoles","onSetDataInit","onSetDataPermisos"])])),_:1})}var D=o(1959),_=o(5474),k=o(589),x=o(3759);const V={components:{methods:x.Z},name:"Permisologia",data(){return{columnsPermisos:[{name:"label",label:"Menu",field:"label",align:"left",sortable:!0},{name:"leer",label:"Leer",align:"center"},{name:"crear",label:"Crear",align:"center"},{name:"editar",label:"Editar",align:"center"},{name:"eliminar",label:"Eliminar",align:"center"},{name:"action",label:"Otros",align:"center"}],form:{acciones:[]},pagination:{rowsPerPage:200,sortBy:"label",descending:!1},permisos:[],agencias:[],agenciasSelected:[],roles:[],rolesPermisos:[],objetos:[],rolesPermisosSelected:[],selected:[],selectedAgencia:[],selectedRol:[],rpermisos:[],menus:[]}},setup(){return{separator:(0,D.iH)("vertical"),permisosForm:(0,D.iH)(!1),loading:(0,D.iH)(!1)}},mounted(){this.$emit("changeTitle","SCEN - Seguridad - Permisologia",""),this.getData("/agencias","setDataInit","agencias"),this.$refs.methods.getData("/rpermisos","setDataPermisos","rpermisos",{headers:{rol:k.Z.getItem("tokenTraducido").usuario.roles.id,menu:"permisologia"}})},methods:{filterArray(e,s,o,a,t){s(""!==e?()=>{const s=e.toUpperCase();for(var i=[],l=0;l<=this[a].length-1;l++)if(this[a][l][t].indexOf(s)>-1&&i.push(this[a][l]),l==this[a].length-1){this[o]=i;break}}:()=>{this[o]=this[a]})},allowOption(e){return this.rpermisos.findIndex((s=>s.acciones.accion==e))<0},setDataPermisos(e,s){this[s]=e,this.rpermisos.findIndex((e=>1==e.acciones.accion))<0&&this.$router.push("/error403")},setDataInit(e,s){this.loading=!0,this[s]=e.data,this.selectedAgencia=this.agencias[0],_.api.get("/roles",{headers:{Authorization:`Bearer ${k.Z.getItem("token")}`,agencia:this.agencias[0].id}}).then((e=>{this.selectedRol=e.data[0],this.rolesPermisos=e.data,this.getData("/menus","setDataMenus","menus",{headers:{rol:this.selectedRol.id}})}))},setData(e,s){this[s]=e},getData(e,s,o,a){this.$refs.methods.getData(e,s,o,a)},setDataRoles(e,s){this[s]=e,this.selectedRol=this.roles[0]},setDataMenus(e,s){this[s]=e;for(let o=0;o<this.menus.length;o++)for(let e=0;e<this.menus[o].acciones.length;e++)this.menus[o].acciones[e].rpermisos.length>0?this.menus[o].acciones[e].bpermisos=!0:this.menus[o].acciones[e].bpermisos=!1;this.loading=!1},updatePermisos(e){e.bpermisos?_.api.post("/rpermisos",{cod_rol:this.selectedRol.id,cod_menu_accion:e.id},{headers:{Authorization:`Bearer ${k.Z.getItem("token")}`}}).then((s=>{this.$q.notify({message:"Agregado exitosamente",color:"green"}),e.rpermisos[0]=s.data})):this.$refs.methods.deleteData(`/rpermisos/${e.rpermisos[0].id}`,"getData")}}};var W=o(4260),q=o(4379),v=o(6778),P=o(151),S=o(5589),Z=o(5735),U=o(8240),$=o(2448),I=o(3414),C=o(2035),A=o(4554),Q=o(6023),R=o(6941),E=o(3884),O=o(7011),j=o(2350),M=o(677),z=o(7518),B=o.n(z);const L=(0,W.Z)(V,[["render",y]]),F=L;B()(V,"components",{QPage:q.Z,QDialog:v.Z,QCard:P.Z,QCardSection:S.Z,QCheckbox:Z.Z,QBtn:U.Z,QSelect:$.Z,QItem:I.Z,QItemSection:C.Z,QIcon:A.Z,QTable:Q.Z,QInnerLoading:R.Z,QTd:E.Z,QList:O.Z,QItemLabel:j.Z}),B()(V,"directives",{ClosePopup:M.Z})}}]);